# /home/aditya244/Downloads/pox/l3firewall.iptables

*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]

# --- 5  Rules (Matching traffic is dropped) ---

# Rule 1: Drop ICMP from 192.168.2.10 (h1) to 192.168.2.30 (h3)
-A OUTPUT -p icmp -s 192.168.2.10 -d 192.168.2.30 -j DROP

# Rule 2: Drop ICMP from 192.168.2.20 (h2) to 192.168.2.40 (h4)
-A OUTPUT -p icmp -s 192.168.2.20 -d 192.168.2.40 -j DROP

# Rule 3: Drop TCP (Port 80) from 192.168.2.20 (h2) to ANY
-A OUTPUT -p tcp -s 192.168.2.20 --dport 80 -j DROP

# Rule 4: Drop TCP from 192.168.2.10 (h1) to 192.168.2.20 (h2)
-A OUTPUT -p tcp -s 192.168.2.10 -d 192.168.2.20 -j DROP

# Rule 5: Drop UDP from 192.168.2.10 (h1) to 192.168.2.20 (h2)
-A OUTPUT -p udp -s 192.168.2.10 -d 192.168.2.20 -j DROP

COMMIT
